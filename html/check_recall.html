<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="author" content="Neil Coffee, Jean-Pierre Koenig, Shakthi Poornima, Chris Forstall, Roelant Ossewaarde">
        <meta name="keywords" content="intertext, text analysis, classics, university at buffalo, latin">
        <meta name="description" content="Intertext analyzer for Latin texts">
        <link href="/css/style.css" rel="stylesheet" type="text/css"/>
        <link href="/images/favicon.ico" rel="shortcut icon"/>

        <title>Tesserae</title>
        <script src="/jquery.js"></script>
        <script src="/tesserae.js"></script>
        <script type="text/javascript">
            var bench_presets = {};
            var lang_presets = {};

            function update_session_meta(meta) {
                $("#search_sel_feature").val(meta.FEATURE)
                $("#search_sel_stop").val(meta.STOP)
                $("#search_sel_stbasis").val(meta.STBASIS)
                $("#search_sel_score").val(meta.SCBASIS)
                $("#search_sel_freq").val(meta.FRBASIS)
                $("#search_sel_dist").val(meta.DIST)
                $("#search_sel_dibasis").val(meta.DIBASIS)
                $("#search_sel_cutoff").val(meta.CUTOFF)
                $("#span_nresults").text(meta.TOTAL)
            }
                        
            function update_bench_meta(bench) {
                if (bench_presets[bench] != undefined) {
                    $("#md_source").text(bench_presets[bench].source)
                    $("#md_target").text(bench_presets[bench].target)
                    $("#md_unit").text(bench_presets[bench].unit)               
                    $("#search_sel_source").val(bench_presets[bench].source)
                    $("#search_sel_target").val(bench_presets[bench].target)
                    $("#search_sel_unit").val(bench_presets[bench].unit)
                    $("#search_sel_bench").val(bench)
                    $("#sort_sel_bench").val(bench)
 
                    var lang = bench_presets[bench].lang
                    if (lang_presets[lang] != undefined) {
                        var feature = lang_presets[lang].feature
                        for (var k in feature) {
                            $("#search_sel_feature").append($("<option />").val(k).text(feature[k])) 
                        }
                    }
                }
            }
            
            $(document).ready(function() {
                var bench = /*bench*/ "default" /*bench*/
                var session = /*session*/ undefined /*session*/
                var sort = /*sort*/ "score" /*sort*/

                $("#nav_main").load("/nav_main.html")
                $("#nav_sub").load("/nav_search.html")
                $("#footer").load("/footer.html")
                
                $("#search_sel_bench").val(bench)
             
                $.getJSON("/bench.json", function(data){
                    bench_presets = data

                    $.getJSON("/search-presets.json", function(data) {
                        lang_presets = data;
        
                        update_bench_meta(bench)
                    
                        if (session != undefined) {
                            $.getJSON("/cgi-bin/ajax-get-meta.pl", {"session":session}, update_session_meta)
                            $("#sort_sel_sort").val(sort)
                            $("#sort_sel_session").val(session)
                            $("#results_sort").show()
                        }
                    })
                })
            })
        </script>
		<style type="text/css">
            div#results_sort {
                display: none;
                text-align: center;
            }
		</style>
   </head>
    <body>
        <div id="container">
            <div id="header">
                <div id="header_image">
                    <a href="/">
                        <img src="/images/Tesserae.png" alt="Tesserae">
                    </a>
                </div>
                <div id="navs">
                    <div id="nav_main">
                    </div>
                    <div id="nav_sub">
                    </div>
                </div>
            </div>
            <div id="main">
                <div id="search_form" class="main_content">
                 	<form action="/cgi-bin/read_table.pl" method="get" id="form_search">

                 		<table class="input">
                 			<tr>
                 				<th>Source:</th>
                 				<td id="md_source"></td>
                 			</tr>
                 			<tr>
                 				<th>Target:</th>
                 				<td id="md_target"></td>
                 			</tr>
             				<tr>
             					<th>Unit:</th>
             					<td id="md_unit"></td>
             				</tr>
             				<tr>
             					<th>Feature:</th>
             					<td>
             						<select id="search_sel_feature" name="feature">
             						</select>
             					</td>
             				</tr>
             				<tr>
             					<th>Number of stop words:</th>
             					<td>
             						<select id="search_sel_stop" name="stopwords">
             							<option value="0">0</option>
             							<option value="10" selected="selected">10</option>
             							<option value="20">20</option>
             							<option value="30">30</option>
             							<option value="40">40</option>
             							<option value="50">50</option>
             							<option value="100">100</option>
             							<option value="150">150</option>
             							<option value="200">200</option>
             						</select>							
             					</td>
             				</tr>
             				<tr>
             					<th>Stoplist basis:</th>
             					<td>
             						<select id="search_sel_stbasis" name="stbasis">
             							<option value="corpus">corpus</option>
             							<option value="target">target</option>
             							<option value="source">source</option>
             							<option value="both" selected="selected">target + source</option>
             						</select>
             					</td>
             				</tr>
             				<tr>
             					<th>Score basis:</th>
             					<td>
             						<select id="search_sel_score" name="score">
             							<option value="word">word</option>
             							<option value="stem">stem</option>
             							<option value="feature">feature</option>								
             						</select>
             					</td>
             				</tr>
                            <tr>
                                <th>Frequency basis:</th>
                                <td>
                                    <select id="search_sel_freq" name="freq_basis">
                                        <option value="text">texts</option>
                                        <option value="corpus">corpus</option>
                                    </select>
                                </td>
                            </tr>
             				<tr>
             					<th>Maximum distance:</th>
             					<td>
             						<select id="search_sel_dist" name="dist">
             							<option value="999">no max</option>
             							<option value="5">5 words</option>
             							<option value="10" selected="selected">10 words</option>
             							<option value="20">20 words</option>
             							<option value="30">30 words</option>
             							<option value="40">40 words</option>
             							<option value="50">50 words</option>
             						</select>							
             					</td>
             				</tr>
             				<tr>
             					<th>Distance metric:</th>
             					<td>
             						<select id="search_sel_dibasis" name="dibasis">
             							<option value="span">span</option>
             							<option value="freq" selected="selected">frequency</option>
             						</select>
             					</td>
             				</tr>
                            <tr>
                                <th><label for="search_sel_cutoff">Score cutoff</label></th>
                                <td>
                                    <select id="search_sel_cutoff" name="cutoff">
                                        <option value="5">5</option>
                                        <option value="6">6</option>
                                        <option value="7">7</option>
                                        <option value="8" selected="selected">8</option>
                                        <option value="9">9</option>    
                                    </select>
                                </td>
                            </td>
             			</table>
                 		<div style="text-align:center; padding:20px;">
                    		<input type="hidden" id="search_sel_source" name="source" />
                    		<input type="hidden" id="search_sel_target" name="target"  />
                    		<input type="hidden" id="search_sel_bench" name="bench" />
                    		<input type="hidden" id="search_sel_unit" name="unit" />
                    		<input type="hidden" name="frontend"  value="recall" />
                 			<input type="submit" value="Compare Texts" ID="btn_search" NAME="btnSubmit" />
                 		</div>
                    </form>
                </div>
                <div id="recall_stats" class="main_content">
				    <b>Total results returned by Tesserae:</b><span id="span_nresults"></span>
                    <table class="output">
    					<thead>
    						<tr>
    							<td>type</td>
    							<td>tesserae returned</td>
    							<td>benchmark has</td>
    							<td>recall rate</td>
    							<td>mean score</td>
    						</tr>
                        </thead>
                        <tbody>
						    <!--recall-stats-->
					    </tbody>
                    </table>
                </div>
        		<div class="main_content_wide" id="results_sort">
                	<form action="/cgi-bin/check-recall.pl" method="get" id="form_sort">
		
                        <label for="sort_sel_sort">Sort by</label>
                        <select id="sort_sel_sort" name="sort">
    				        <option value="target">target locus</option>
    				        <option value="score">tess score</option>
    				        <option value="type">parallel type</option>
                        </select>.
        				<input type="hidden" id="sort_sel_session" name="session" />
        				<input type="hidden" id="sort_sel_bench" name="bench" />
        				<input type="submit" name="submit"  value="Change Display" />
                	</form>
        		</div>
                <div class="main_content_wide" id="results">
                    <table class="output" id="resultsTable">
        				<thead>
        					<tr>
        						<th>Target Loc</th>
        						<th>Target Phrase</th>
        						<th>Source Loc</th>
        						<th>Source Phrase</th>
        						<th>Parallel Type</th>
        						<th>Tess Score</th>
        						<th>Commentators</th>
        					</tr>
        				</thead>
        				<tbody>
        					<!--parallels-->
        				</tbody>
        			</table>
                </div>
            </div>
            <div id="footer">
			</div>
		</div> <!--closes container-->
	</body>
</html>

         